# -*- coding: utf-8 -*-
"""data_fetch(TMDB).ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1utObAnI_ziCAjT-anr3xU37yIrOL4Mks

#**DATA COLLECTION**
"""

import requests
import pandas as pd

API_KEY = 'Your_API_KEY'#the API key can be received by signing up in the TMDB (The Movie Database).

def get_movies(url):
    response = requests.get(url)
    return response.json()

def get_movie_details(movie_id):
    url = f'https://api.themoviedb.org/3/movie/{movie_id}?api_key={API_KEY}'
    response = requests.get(url)
    return response.json()

def get_movie_credits(movie_id):
    url = f'https://api.themoviedb.org/3/movie/{movie_id}/credits?api_key={API_KEY}'
    response = requests.get(url)
    return response.json()

def fetch_all_movies(pages=5):
    movies_data = []

    def fetch_movies(url_template):
        for page in range(1, pages + 1):
            url = url_template.format(page=page)
            movies = get_movies(url)
            for movie in movies['results']:
                movies_data.append(movie)

    # Fetch popular movies
    popular_url_template = f'https://api.themoviedb.org/3/movie/popular?api_key={API_KEY}&language=en-US&page={{page}}'
    fetch_movies(popular_url_template)

    # Fetch upcoming movies
    upcoming_url_template = f'https://api.themoviedb.org/3/movie/upcoming?api_key={API_KEY}&language=en-US&page={{page}}'
    fetch_movies(upcoming_url_template)

    # Fetch top-rated movies
    top_rated_url_template = f'https://api.themoviedb.org/3/movie/top_rated?api_key={API_KEY}&language=en-US&page={{page}}'
    fetch_movies(top_rated_url_template)
    industries = {
        'Bollywood': 'hi',  # Hindi language for Bollywood
        'Tollywood': 'te',  # Telugu language for Tollywood
        # Add more industries and their language codes as needed
    }
    for industry, language in industries.items():
        # Fetch popular movies
        popular_url_template = f'https://api.themoviedb.org/3/discover/movie?api_key={API_KEY}&language=en-US&sort_by=popularity.desc&with_original_language={language}&page={{page}}'
        fetch_movies(popular_url_template)

        # Fetch upcoming movies
        upcoming_url_template = f'https://api.themoviedb.org/3/movie/upcoming?api_key={API_KEY}&language={language}&page={{page}}'
        fetch_movies(upcoming_url_template)

        # Fetch top-rated movies
        top_rated_url_template = f'https://api.themoviedb.org/3/movie/top_rated?api_key={API_KEY}&language={language}&page={{page}}'
        fetch_movies(top_rated_url_template)

    movie_details_data = []
    for movie in movies_data:
        movie_id = movie['id']
        details = get_movie_details(movie_id)
        credits = get_movie_credits(movie_id)
        movie_details_data.append({
            'title': details.get('title', ''),
            'budget': details.get('budget', 0),
            'revenue': details.get('revenue', 0),
            'genres': [genre['name'] for genre in details.get('genres', [])],
            'cast': [cast['name'] for cast in credits.get('cast', [])],
            'crew': [crew['name'] for crew in credits.get('crew', [])],
            'runtime': details.get('runtime', 0),
            'release_date': details.get('release_date', '')
        })

    return pd.DataFrame(movie_details_data)

df = fetch_all_movies(pages=30)

df.to_csv('movies_data.csv', index=False)

